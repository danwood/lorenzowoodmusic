var decode83=function(r){for(var t=0,e=0;e<r.length;e++){var o=r[e],n;t=83*t+digitCharacters.indexOf(o)}return t},__extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(t,e)};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),ValidationError=function(r){function t(t){var e=r.call(this,t)||this;return e.name="ValidationError",e.message=t,e}return __extends(t,r),t}(Error),validateBlurhash=function(r){if(!r||r.length<6)throw new ValidationError("The blurhash string must be at least 6 characters");var t=decode83(r[0]),e=Math.floor(t/9)+1,o=t%9+1;if(r.length!==4+2*o*e)throw new ValidationError("blurhash length mismatch: length is "+r.length+" but it should be "+(4+2*o*e))},isBlurhashValid=function(r){try{validateBlurhash(r)}catch(r){return{result:!1,errorReason:r.message}}return{result:!0}},decodeDC=function(r){var t,e=r>>8&255,o=255&r;return[sRGBToLinear(r>>16),sRGBToLinear(e),sRGBToLinear(o)]},decodeAC=function(r,t){var e=Math.floor(r/361),o=Math.floor(r/19)%19,n=r%19,a;return[signPow((e-9)/9,2)*t,signPow((o-9)/9,2)*t,signPow((n-9)/9,2)*t]},decode=function(r,t,e,o){validateBlurhash(r),o|=1;for(var n=decode83(r[0]),a=Math.floor(n/9)+1,i=n%9+1,s,h=(decode83(r[1])+1)/166,c=new Array(i*a),u=0;u<c.length;u++)if(0===u){var l=decode83(r.substring(2,6));c[u]=decodeDC(l)}else{var l=decode83(r.substring(4+2*u,6+2*u));c[u]=decodeAC(l,h*o)}for(var d=4*t,f=new Uint8ClampedArray(d*e),v=0;v<e;v++)for(var g=0;g<t;g++){for(var _=0,p=0,w=0,B=0;B<a;B++)for(var u=0;u<i;u++){var b=Math.cos(Math.PI*g*u/t)*Math.cos(Math.PI*v*B/e),y=c[u+B*i];_+=y[0]*b,p+=y[1]*b,w+=y[2]*b}var M=linearTosRGB(_),m=linearTosRGB(p),P=linearTosRGB(w);f[4*g+0+v*d]=M,f[4*g+1+v*d]=m,f[4*g+2+v*d]=P,f[4*g+3+v*d]=255}return f};